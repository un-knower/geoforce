<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>地图操作-覆盖物-添加</title>
<link href="js_color_picker_v2.css" rel="stylesheet" type="text/css"></link>
<script type="text/javascript" src="../../include.js"></script>	
<script type="text/javascript" src="../../script/SuperMap.Include.js"></script>	
 <script type="text/javascript" src="../../script/osp.js"></script>	
 <script type="text/javascript" src="js_color_picker_v2.js"></script>
</script>
<script type="text/javascript">

	var map = null;	//地图控件
	var featuresLayer = null;	//承载 Feature 矢量图
	var drawPoint,drawLine,drawPolygon;

	//初始化地图
	function initMap() {
		
		map = getMap("mapDiv");	//显示地图
		featuresLayer = new SuperMap.Layer.Vector();
		drawLine = new SuperMap.Control.DrawFeature(featuresLayer,SuperMap.Handler.Path, { multi: true });
		drawLine.events.on({"featureadded": drawCompleted});
		drawPoint = new SuperMap.Control.DrawFeature(featuresLayer,SuperMap.Handler.Point, { multi: true });
		drawPoint.events.on({"featureadded":drawCompleted});
		drawPolygon = new SuperMap.Control.DrawFeature(featuresLayer,SuperMap.Handler.Polygon, { multi: true });
		drawPolygon.events.on({"featureadded":drawCompleted});
		map.addLayer(featuresLayer);
		map.addControls([drawLine,drawPoint,drawPolygon]);
	}
	

	//绘制点
	function drawPointEntity() {
		var fillColor = document.getElementById("color1").value;
				if (fillColor.indexOf("#") != 0) {
					alert("填充颜色为非法值!");
					return false;
				}
				var strokeColor = document.getElementById("color2").value;
				if (strokeColor.indexOf("#") != 0) {
					alert("边线颜色为非法值!");
					return false;
				}
				var opacity = document.getElementById("txtOpacity").value;
				if (isNaN(opacity)) {
					alert("透明度的范围在【0-1.0】之间!");
					return false;
				}
				var lineWidth = document.getElementById("txtLineWidth").value;
				if (isNaN(lineWidth)) {
					alert("边线宽度应该是数值型");
					return false;
				}
				featuresLayer.style = {fillColor:fillColor,strokeColor:strokeColor,strokeWidth:lineWidth,pointRadius:6,strokeOpacity:opacity,fillOpacity:opacity,strokeWidth:lineWidth};
				drawPoint.activate();
	}

	//绘制线
	function drawLineEntity() {
		drawLine.activate();
	}

	//绘制面
	function drawPolygonEntity() {
		drawPolygon.activate();
	}
	
	//将绘制的图形加载到矢量要素图层上。绘制点、线和面结束后传回的回调函数中都是DrawGeometryArgs类型的参数，而绘制圆后传回的回调函数的参数为 DrawCircleArgs，因此以下这个函数不能将圆加载到矢量图层上
	var feature;
	function drawCompleted(drawGeometryArgs) {
		var fillColor = document.getElementById("color1").value;
		if (fillColor.indexOf("#") != 0) {
			alert("填充颜色为非法值!");
			return false;
		}
		var strokeColor = document.getElementById("color2").value;
		if (strokeColor.indexOf("#") != 0) {
			alert("边线颜色为非法值!");
			return false;
		}
		var opacity = document.getElementById("txtOpacity").value;
		if (isNaN(opacity)) {
			alert("透明度的范围在【0-1.0】之间!");
			return false;
		}
		var lineWidth = document.getElementById("txtLineWidth").value;
		if (isNaN(lineWidth)) {
			alert("边线宽度应该是数值型");
			return false;
		}
		featuresLayer.style = {fillColor:fillColor,strokeColor:strokeColor,strokeWidth:lineWidth,pointRadius:6,strokeOpacity:opacity,fillOpacity:opacity,strokeWidth:lineWidth};
		drawLine.deactivate();
			drawPoint.deactivate();
			drawPolygon.deactivate();
			var geometry = drawGeometryArgs.feature.geometry;
			feature = new SuperMap.Feature.Vector(geometry);
		
	}
		
	//清除所有要素
	function clearFeatures() {
		featuresLayer.removeAllFeatures();
	}
</script>
</head>

<body onLoad="initMap()">

<!--地图控件-->
<div id="mapDiv" style="width: 880px; height: 580px;"></div>
<form>
<table style="font-size: 12px">
  <tr>
    <td> 填充颜色： </td>
    <td><input type="text" size="10" id="color1" maxlength="7" name="rgb1" value="#FF0000" onClick="showColorPicker(this,document.forms[0].rgb1)"></td>
  </tr>
  <tr>
    <td> 填充透明度： </td>
    <td><select id="txtOpacity">
        <option value="0.1">0.1</option>
        <option value="0.2">0.2</option>
        <option value="0.3">0.3</option>
        <option value="0.4">0.4</option>
        <option value="0.5" selected="">0.5</option>
        <option value="0.6">0.6</option>
        <option value="0.7">0.7</option>
        <option value="0.8">0.8</option>
        <option value="0.9">0.9</option>
        <option value="1.0">1.0</option>
      </select></td>
  </tr>
  <tr>
    <td> 线宽： </td>
    <td><input type="text" id="txtLineWidth" style="width: 50px" value="2"></td>
  </tr>
  <tr>
    <td> 边线颜色： </td>
    <td><input type="text" size="10" id="color2" maxlength="7" name="rgb2" value="#0000FF" onClick="showColorPicker(this,document.forms[0].rgb2)"></td>
  </tr>
</table>
</form>
<button onClick="drawPointEntity();">绘制点</button>
<button onClick="drawLineEntity();">绘制线</button>
<button onClick="drawPolygonEntity();">绘制多边形</button>
<button onClick="clearFeatures();">清除</button>
</body>
</html>
