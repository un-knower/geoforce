		var script2 = '<' + 'script type="text/javascript"  src="js/key.js"' + '><' + '/script>';	document.writeln(script2);	// var link1 = '<' + 'script type="text/javascript" src="script/jquery-1.5.1.min.js"' + '><' + '/script>';	// document.writeln(link1);	// var link2 = '<' + 'script type="text/javascript" src="script/jquery-ui-1.8.11.custom.min.js"' + '><' + '/script>';	// document.writeln(link2);	var script3 = '<' + 'script type="text/javascript"  src="script/jquery.js"' + '><' + '/script>';	document.writeln(script3);	//获取服务端访问地址function getServiceUrl(){	var serviceUrl = "http://services.supermapcloud.com";    return serviceUrl;}/** * 用户模块扩展 * @author mwang */var User = {	currentUser: null	//当前登录用户};/** * 加载当前登录用户的信息 * @author mwang */User.loadCurrentUser = function(hasUserCallback, hasnoUserCallback){	var userService = new SuperMap.OSP.SystemMaintenanceService.UserService();	userService.url = getServiceUrl();	var id = -1;	userService.findUserById(id,		function(result) {	//存在登录用户			if (result) {				User.currentUser = result;//保存登录用户信息				if(jQuery.isFunction(hasUserCallback)){					hasUserCallback(result);				}			}		}, function(errorResult) {//不存在登录用户			if(jQuery.isFunction(hasnoUserCallback)){				hasnoUserCallback(errorResult);			}		}	);}/** * 更新用户登录状态提示 * @author mwang */User.changeLoginTip = function(){	if(User.currentUser){		var currentUser = "<a href='http://www.supermapcloud.com/cloudweb/user.jsp' target='_blank'>" + User.currentUser.name + "</a>";		var loginSuccessDom = jQuery("<a href='javascript:void(0);'/>").html("退出").click(function(){			User.loginOut(function(){				User.currentUser = null;				User.changeLoginTip();			});		});		//jQuery("<a href='user.jsp' target='_blank'>" + User.currentUser.name + "</a>").append();		//User.loginOut(function(){User.changeLoginTip()})		jQuery("#span_loginTip").css("display", "none");		jQuery("#span_loginSuccessTip").html(currentUser).append(loginSuccessDom).css("display", "inline");	}else{		jQuery("#span_loginTip").css("display", "inline");		jQuery("#span_loginSuccessTip").html("");	}}/** * 显示登录窗口 * @author mwang */User.showLoginDialog = function(){	if(jQuery("#loginWindow").length == 0){	//没有登录页面则加载		var loginUrl = "page/user/login.html";	//登录页面url		var div = jQuery("<div/>");		jQuery("body").prepend(div);		div.load(loginUrl, function(r){			jQuery("#loginWindow").dialog({				height: 200,				width: 280,				show: 'fade',				modal: true,				draggable: false,				resizable: false,				open: function() {					jQuery("#userName").attr("value", "");					jQuery("#password").attr("value", "");				}			});			jQuery("#loginWindow").css("overflow", "visible").dialog("open");			jQuery("#loginWindow").css("overflow", "visible").dialog("open");		});	}else{		//显示登录窗口		jQuery("#loginWindow").css("overflow", "visible").dialog("open");	}}/** * 登陆提交 * @author mwang */User.loginCommit = function() {	var username = document.getElementById("userName").value;	var password = document.getElementById("password").value;	if (username == "") {		//objUser.innerHTML = "<font color=red>用户名不能为空！</font>";		alert("用户名不能为空！");		return false;	}	if (password == "") {		//objPassword.innerHTML = "<font color=red>密码不能为空！</font>";		alert("密码不能为空！");		return false;	}	else{		//为用户密码加密 		password = encrypt(password);	}		var userService = new SuperMap.OSP.SystemMaintenanceService.UserService();	userService.url = getServiceUrl();	userService.checkUser(username, password,		function(result) {			if (result) {				User.currentUser = result;//保存登录用户信息				jQuery("#a_cloudhost").attr("href", "../cloudweb/cloudhost_introduce_loaded.jsp");	            jQuery("#a_cloudapp").attr("href", "../cloudweb/cloudapp.jsp");	            // jQuery("#a_clouddata").attr("href", "http://www.supermapcloud.com/cloudweb/cloudData.jsp");				jQuery( "#loginWindow" ).dialog("close");				User.changeLoginTip();			} else {				//objInfo.innerHTML = "<font color=red>登录失败</font>";			}		},		function(errorResult) {			alert(errorResult.information);		});}/** * 用户推出登录 * @author mwang */User.loginOut = function(loginOutSuccessCallback, loginOutFailCallback) {	var userService = new SuperMap.OSP.SystemMaintenanceService.UserService();	userService.url = getServiceUrl();	userService.logout(		function() {	//用户退出成功			jQuery("#a_cloudhost").attr("href", "../cloudweb/cloudhost_introduce.jsp");			jQuery("#a_cloudapp").attr("href", "../cloudweb/cloudapp_introduce.jsp");			// jQuery("#a_clouddata").attr("href", "http://www.supermapcloud.com/cloudweb/cloudData_introduce.jsp");			if(jQuery.isFunction(loginOutSuccessCallback)){				loginOutSuccessCallback();			}		},		function(errorResult) {	//用户退出失败			if(jQuery.isFunction(loginOutFailCallback)){				loginOutFailCallback(errorResult);			}		}	);}//为用户密码加密的函数function encrypt(password){	var hashMap = getHashMap();	var newPassword = "";	for(var i = 0; i < password.length; i++){		//改变用户输入的密码		var passwordEncrypt = password.substr(i,1);		passwordEncrypt = hashMap.get(passwordEncrypt);		newPassword += passwordEncrypt;	}	return newPassword;}	 ///用户密码加密的散列文件function getHashMap(){	var hashMap = new SuperMap.OSP.Core.HashMap();	hashMap.put("0", "0");	hashMap.put("1", "9");	hashMap.put("2", "8");	hashMap.put("3", "7");	hashMap.put("4", "6");	hashMap.put("5", "5");	hashMap.put("6", "4");	hashMap.put("7", "3");	hashMap.put("8", "2");	hashMap.put("9", "1");	hashMap.put("a", "q");	hashMap.put("b", "w");	hashMap.put("c", "e");	hashMap.put("d", "r");	hashMap.put("e", "t");	hashMap.put("f", "y");	hashMap.put("g", "u");	hashMap.put("h", "i");	hashMap.put("i", "o");	hashMap.put("j", "p");	hashMap.put("k", "a");	hashMap.put("l", "s");	hashMap.put("m", "d");	hashMap.put("n", "f");	hashMap.put("o", "g");	hashMap.put("p", "h");	hashMap.put("q", "j");	hashMap.put("r", "k");	hashMap.put("s", "l");	hashMap.put("t", "z");	hashMap.put("u", "x");	hashMap.put("v", "c");	hashMap.put("w", "v");	hashMap.put("x", "b");	hashMap.put("y", "n");	hashMap.put("z", "m");	hashMap.put("A", "Q");	hashMap.put("B", "W");	hashMap.put("C", "E");	hashMap.put("D", "R");	hashMap.put("E", "T");	hashMap.put("F", "Y");	hashMap.put("G", "U");	hashMap.put("H", "I");	hashMap.put("I", "O");	hashMap.put("J", "P");	hashMap.put("K", "A");	hashMap.put("L", "S");	hashMap.put("M", "D");	hashMap.put("N", "F");	hashMap.put("O", "G");	hashMap.put("P", "H");	hashMap.put("Q", "J");	hashMap.put("R", "K");	hashMap.put("S", "L");	hashMap.put("T", "Z");	hashMap.put("U", "X");	hashMap.put("V", "C");	hashMap.put("W", "V");	hashMap.put("X", "B");	hashMap.put("Y", "N");	hashMap.put("Z", "M");		return hashMap;}	/*--------------------用户申请key--begin--------------------------*/	function createKey(){		if(User==null){			alert("必须登录后才能获取key");			return;		}		var radio_article = jQuery("input[type='radio'][name='radio_article']:checked").val();		if(radio_article == 0){			alert("必须同意条款才能获取key!");			return;		}		var domain = jQuery("#keyURL").val();		if(domain == ""){			alert("网站地址是必填项!");			return;		}				var userService = new SuperMap.OSP.SystemMaintenanceService.LicenseManage();		userService.url = ospUrl;		userService.createKey( domain, function(result) {			if (result){				var html = ospUrl + "/iserver/api?key=" + encodeURIComponent(result.licenseKey);				// userInfo.userKey = html;				setHtml("createKey", html);				alert("申请成功!");			}		}, function(errorResult){			alert("申请KEY失败,"+errorResult.information);		});	}		/*-----------------用户申请key---end------------------------*/	function setTab( showIndex,obj){		jQuery("#sddm li a").attr("class", "sddm_li_a");		var i = showIndex-1;		if(showIndex > 4) i = showIndex+3;				if(showIndex == 8 || showIndex == 9){			jQuery("#sddm li a[href='#']:eq("+4+")").addClass("sddm_li_a_hover");		}		else{			jQuery("#sddm li a[href='#']:eq("+i+")").addClass("sddm_li_a_hover");		}				for (var i = 1;i <= 12; i++ ){			var contextId=document.getElementById("context_"+ i);			if(contextId){			 contextId.style.display="none";}				 }			var currentId = document.getElementById("current");            if (currentId) {                currentId.id = "";            }			var currentcontextId = document.getElementById("context_" + showIndex);            if (currentcontextId) {                currentcontextId.style.display = "block";            }			if(showIndex == 1){				var id = document.getElementById("default");				id.style.display = "block";				var speedId = document.getElementById("speed");				speedId.style.display = "none";			}			if(showIndex == 3){				showGuidePanel("guideBaseKnowledge");	//显示基础知识			}			if(showIndex == 4){				selectSample('0', this);			}	 }	function fold(){		setTab('1',this);		var id = document.getElementById("default");		id.style.display = "none";		var speedId = document.getElementById("speed");		speedId.style.display = "block";	}		//开发指南面板切换	function showGuidePanel(panelName){		jQuery("div[id^='div_guidePanel']").css("display", "none");		jQuery("div[id='div_guidePanel_"+panelName+"']").css("display", "block");	}	 /*	 //enter键触发关键字搜索	 function keySearchEnter(){		if(window.event.keyCode == 13){			var button = document.getElementById("btnKeySearch");			button.click();			return false;		}	 }	 //enter触发地址匹配	 function geoCoderEnter(){		if(event.keyCode == 13){			var button = document.getElementById("btnGeoCoder");			button.click();			return false;		}	 }*/<!--var timeout         = 500;var closetimer		= 0;var ddmenuitem      = 0;// open hidden layerfunction mopen(id){		// cancel close timer	mcancelclosetime();	// close old layer	if(ddmenuitem) ddmenuitem.style.visibility = 'hidden';	// get new layer and show it	ddmenuitem = document.getElementById(id);	ddmenuitem.style.visibility = 'visible';}// close showed layerfunction mclose(){	if(ddmenuitem) ddmenuitem.style.visibility = 'hidden';}// go close timerfunction mclosetime(){	closetimer = window.setTimeout(mclose, timeout);}// cancel close timerfunction mcancelclosetime(){	if(closetimer)	{		window.clearTimeout(closetimer);		closetimer = null;	}}// close layer when click-outdocument.onclick = mclose; // -->